<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
  <style>
    body {color:rgb(149, 146, 146);
    background-color:rgb(84, 84, 84)}
    label {color:#fff;
    background-color:#800}
    button {background-color:#fff;
     border:none;
     border-radius:4px;
     min-width:24px;
     padding:4px 4px 2px 4px;
    }
    canvas {
    padding-left: 28px;
    padding-top: 30px;}
    canvas[id=hud] {
    padding: 0px;
    white-space: nowrap; }

    canvas [id=OC]{
     top:-600px;
     left:-600px;
    }
    div {
    padding-left: 20px;
    padding-top: 6px;}
    div[id=message] {
      position:absolute;
      top:360px;
      left:366px;
      color:#fff;
      display: none;
      border:2px solid #000000;
      padding:8px;
      font-size:24px;
      z-index:4;
    }
    div[id=gb]{
    border-radius:6px 6px 70px 6px;
    background-color: rgb(133, 227, 229);
    padding:0px;
    width:500px;
    height:600px;
    }
    svg { color:#f00;
    padding: 2px;
    padding-top: 8px;
    fill:#f00;}
  .outer-container {
    display: grid;
    grid-template-columns: 330px 90px;
    padding-top: 2px;
    padding-left: 20px;
    padding-bottom: 18px; 
  }
  .outer-item {
  /*border: 1px solid rgba(0, 0, 0, 0.8);*/
    padding: 2px;
    font-size: 30px;
    height:110px;
    text-align: center;
  }
  .grid-container {
    display: grid;
    grid-template-columns: 32px 32px 32px auto 12px 36px 36px;
    grid-template-rows: 32px 32px 32px ;
    width:240px;
    padding-top: 2px;
    padding-left: 20px;
    padding-bottom: 18px; 
  }
  .grid-item {
  /*border: 1px solid rgba(0, 0, 0, 0.8);*/
    padding: 2px;
    font-size: 30px;
    text-align: center;
  }
  a {color:#fff;
  text-decoration: none;
  vertical-align: top;
  line-height: 24px;}
  </style>
  </head>
  <body>
  <div id="gb" width="450">
    <div id="message"></div>
    <canvas id="myCanvas" width="440" height="450" style="border:0px solid #000000;">
    </canvas>
    <canvas id="OC" width="1600" height="1600" style="border:1px solid #000000;display:none;">
    </canvas>
<div class="outer-container">
  <div class="outer-item">
    <div class="grid-container">
      <div class="grid-item"></div>
      <div class="grid-item" style="background-color: #000000;"><a href="javascript:up()" title='up' style="line-height: 24px;">
      &uarr;</a></div>
      <div class="grid-item"></div>  
      <div class="grid-item"></div>
      <div class="grid-item"></div>
      <div class="grid-item"></div>  
      <div class="grid-item" >
      <a href="javascript:nextMap()" title='next map'>
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="red" class="bi bi-fast-forward-circle-fill" viewBox="0 0 16 16">
      <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M4.79 5.093 8 7.386V5.5a.5.5 0 0 1 .79-.407l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 8 10.5V8.614l-3.21 2.293A.5.5 0 0 1 4 10.5v-5a.5.5 0 0 1 .79-.407"/>
      </svg></a></div>
      <div class="grid-item" style="background-color: #000000;vertical-align: top;padding-bottom:12px;">
      <a href="javascript:left()" title='left' style="line-height: 24px;">
        &larr;</a></div>
      <div class="grid-item" style="background-color: #000000;"></div>  
      <div class="grid-item" style="background-color: #000000;"><a href="javascript:right()" title='right'>
        &rarr;</a></div> 
      <div class="grid-item"></div> 
      <div class="grid-item"></div> 
      <div class="grid-item"><a href="javascript:startOver()" title='start over'>
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="red" class="bi bi-1-circle-fill" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312z"/>
      </svg></a>
      </div> 
      <div class="grid-item"></div> 
      <div class="grid-item"></div>
      <div class="grid-item"style="background-color: #000000;"><a href="javascript:down()" title='down'>
        &darr;</a></div>  
      <div class="grid-item"></div>   
      <div class="grid-item"></div> 
      <div class="grid-item"></div> 
      <div class="grid-item"></div> 
      <div class="grid-item"></div>
    </div>
  </div>
  <div class="outer-item">
     <canvas id="hud" width="80" height="80"></canvas>
  </div>
</div>

</body>
<script>
// globals
let things = [], RIGHT = true, UP = false, VERT = false, THETHING = "ghostAt"
let HP = 3, COINS = 0, KEYS = 0, MASKS = 0, LEVEL = 1, SWORDS = 0, HITS = 0, LIGHTS = 0
let ux = 0, uy = 0, MAPINDEX = 1

let c1 = ["#85a715", "#71941d", "#597c26", "#3e6230", "#132407"]
let c2 = ["#9ca4ff", "#7f83ff", "#6267ff", "#4c52ff", "#141955"]
let c3 = ["#ffb500", "#fd9b00", "#dc7d00", "#b95700", "#4d2c0f"]
let c4 = ["#e4a6fb", "#b573fc", "#884cfc", "#6929fc", "#2f1a60"]
let c5 = ["#c9c9c9", "#969696", "#747474", "#525252", "#303030"]
let c6 = ["#ffc766", "#cc9433", "#aa7211", "#885000", "#662e00"]
let c7 = ["#ffa8a8", "#cc7575", "#aa5353", "#883131", "#660f0f"]
     
let colors = [c1,c2,c3,c4,c5,c6,c7]
let retrocolors = []

const consumables = ["maskAt","virusAt","monsterAt", "skullAt", "ghostAt", "spiderAt", "heartAt", "coinAt", "flaskAt", "keyAt", "swordAt"]
const unmovables = ["userAt", "filledAt", "stairsAt", "treasureAt","bulbAt"]
let MAP = "Bad Bug"
let Maps = {
 // "Awful Attic":[1440,1441,1442,1443,1595,1556,1517,1478,1439,1479,1519,1518,1558,1559,1599,1598,1597,1596,1557,1444,1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1470,1471,1472,1473,1474,1403,1362,1321,1280,1320,1360,1400,1361,1401,1402,1203,1204,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,1239,1238,1237,1236,1197,1158,1119,1159,1199,1198,1232,1231,1230,1229,1233,1202,1475,1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1015,1016,1017,1018,1019,1020,1021,1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1038,998,999,1039,959,1037,879,878,877,876,875,874,872,870,868,866,864,862,860,858,859,857,856,855,847,846,849,851,852,853,843,802,761,720,760,800,801,840,840,841,842,848,850,854,861,863,865,867,869,871,873,680,681,682,683,684,685,686,687,689,691,693,695,697,699,700,701,698,702,703,704,705,711,716,677,638,599,639,679,719,718,717,678,712,708,709,710,707,706,713,696,694,692,690,688,657,618,579,619,660,659,658,620,661,542,543,544,545,546,547,535,534,533,532,531,530,529,528,527,526,525,548,549,550,551,552,553,554,555,556,558,557,559,520,521,522,523,524,536,539,499,459,419,379,339,340,341,342,343,344,345,357,358,359,319,318,279,199,158,198,197,196,179,219,338,337,336,335,334,333,332,331,325,326,327,322,281,240,280,320,321,180,178,181,182,183,177,176,174,330,329,328,354,353,352,351,348,349,350,347,346,159,119,157,118,79,259,299,192,191,190,189,188,187,186,185,184,193,175,171,172,173,166,167,168,169,170,164,165,163],
 //1560,600
   "Exit Right": [0,39,41,78,42,77,2,37,1,38,40,79,480,519,440,479,400,439,441,478,402,437,401,438,362,397,363,396,323,356,322,357,321,358,361,398,360,399,320,359,161,198,201,238,241,278,281,318,81,118,121,158,80,119,120,159,160,199,200,239,240,279,280,319,282,317,202,237,162,197,82,117,122,157,242,277,324,355,285,314,246,273,207,232,168,191,129,150,90,109,51,68,12,27,11,28,206,233,166,193,126,153,86,113,46,73,47,72,87,112,127,152,167,192,128,151,88,111,48,71,49,70,89,110,50,69,245,274,244,275,284,315,283,316,243,276,204,235,164,195,84,115,124,155,85,114,125,154,165,194,205,234,203,236,163,196,123,156,83,116,43,76,44,75,45,74,5,34,4,35,3,36,6,33,7,32,8,31,9,30,10,29,1520,1559,1561,1598,1560,1599,1521,1558,1482,1517,1522,1557,1562,1597,1481,1518,1480,1519,1440,1479,1441,1478,1442,1477,1443,1476,1483,1516,1523,1556,1563,1596,1579,1580,1539,1540,1499,1500,1459,1460,1419,1420,1379,1380,1339,1340,1299,1300,1259,1260,1219,1220,19,20,59,60,99,100,139,140,179,180,219,220,259,260,299,300,339,340,379,380,419,420,459,460,1179,1180,1139,1140,1404,1435,1444,1475,1484,1515,1524,1555,1564,1595,1403,1436,1402,1437,1401,1438,1400,1439,1418,1421,1417,1422,1416,1423,1456,1463,1457,1462,1458,1461,1498,1501,1497,1502,1496,1503,1415,1424,1455,1464,1495,1504,1535,1544,1575,1584,1576,1583,1577,1582,1537,1542,1536,1543,1538,1541,1578,1581,1532,1547,1533,1546,1573,1586,1572,1587,1574,1585,1534,1545,1494,1505,1454,1465,1414,1425,1413,1426,1453,1466,1453,1466,1492,1507,1452,1467,1412,1427,1493,1506,1486,1513,1487,1512,1488,1511,1489,1510,1490,1509,1491,1508,1531,1548,1571,1588,1570,1589,1530,1549,1529,1550,1569,1590,1568,1591,1528,1551,1527,1552,1567,1592,1566,1593,1526,1553,1565,1594,1525,1554,1485,1514,1445,1474,1405,1434,1406,1433,1446,1473,1447,1472,1407,1432,1408,1431,1448,1471,1409,1430,1449,1470,1410,1429,1450,1469,1411,1428,1451,1468,1364,1395,1363,1396,1362,1397,1361,1398,1360,1399,1320,1359,1321,1358,1322,1357,1323,1356,1282,1317,1281,1318,1280,1319,1240,1279,1241,1278,1200,1239,1098,1101,1059,1060,1099,1100,1058,1061,1138,1141,1178,1181,1218,1221,1258,1261,1298,1301,1338,1341,1378,1381,501,498,500,499,458,461,418,421,378,381,338,341,298,301,258,261,218,221,178,181,138,141,98,101,58,61,18,21,17,22,16,23,15,24,13,26,14,25,52,67,53,66,54,65,55,64,56,63,57,62,97,102,96,103,95,104,94,105,93,106,92,107,91,108,130,149,131,148,132,147,133,146,134,145,135,144,136,143,137,142,169,190,170,189,171,188,172,187,173,186,174,185,175,184,176,183,177,182,217,222,216,223,215,224,214,225,213,226,212,227,211,228,210,229,209,230,208,231,248,271,247,272,249,270,250,269,251,268,252,267,253,266,254,265,255,264,256,263,257,262,1120,1159,1160,1199,1161,1198,1201,1238,1202,1237,1242,1277,1243,1276,1283,1316,1284,1315,1324,1355,1325,1354,1365,1394,1366,1393,1367,1392,1368,1391,1369,1390,1370,1389,1371,1388,1372,1387,1373,1386,1374,1385,1375,1384,1376,1383,1377,1382,1326,1353,1285,1314,1244,1275,1203,1236,1162,1197,1121,1158,1080,1119,1040,1079,1081,1118,1122,1157,1163,1196,1204,1235,1245,1274,1286,1313,1327,1352,538,541,539,540,578,581,579,580,618,621,619,620,1018,1021,1019,1020,297,302,1337,1342,1336,1343,1297,1302,296,303,337,342,255,264,295,304,336,343,377,382,1335,1344,1296,1303,1257,1262,659,660,658,661],
  "Diagonal":[1443,1484,1525,1566,1450,1409,1368,1327,1286,1245,1204,1163,1122,1081,1040,1576,1536,1496,1456,1416,1375,1334,1293,1252,1211,1170,1129,1088,1047,1006,965,560,561,562,563,564,565,606,647,688,729,770,811,852,893,934,975,1016,1057,1098,1139,1180,1221,1262,1303,1344,1385,1591,1551,1511,1471,1431,1391,1351,1311,1270,1229,1188,1147,1065,1106,1024,983,942,901,860,819,778,737,696,655,614,573,532,491,450,409,368,327,286,245,204,9,50,91,132,173,214,255,296,337,378,419,460,501,542,583,624,665,706,747,788,829,925,885,1424,1463,164,1403,870,911,952,993,839,798,757,716,675,634,593,552,511,470,429,388,347,306,265,224,183,29,70,111,152,193,234,275,316,143,1034,1075,1115,1155,356,396,1195,1235,1275,1315,1355,1395,1395,1435,845,124,436],
  "The Snake":[4,35,9,30,14,25,19,20,124,155,164,195,204,235,244,275,284,315,324,355,364,395,49,70,89,110,129,150,169,190,209,230,249,270,289,310,329,350,369,390,409,430,449,470,134,145,174,185,214,225,254,265,294,305,334,345,374,385,414,425,454,465,1569,1590,1449,1470,1409,1430,1369,1390,1329,1350,1289,1310,1249,1270,1564,1595,1524,1555,1484,1515,1444,1475,1404,1435,1364,1395,1324,1355,1284,1315,1244,1275,1204,1235,1164,1195,1124,1155,1044,1075,1084,1115,1574,1585,1534,1545,1494,1505,1454,1465,1414,1425,1374,1385,1334,1345,1294,1305,1254,1265,1214,1225,1174,1185,1134,1145,1094,1105,1054,1065,1014,1025,974,985,934,945,894,905,1209,1230,1169,1190,1129,1150,1089,1110,1049,1070,1009,1030,969,990,929,950,889,910,849,870,809,830,769,790,729,750,689,710,649,670,609,630,569,590,529,550,489,510,494,505,534,545,574,585,614,625,654,665,694,705,734,745,774,785,814,825,854,865,404,435,444,475,484,515,524,555,564,595,604,635,644,675,684,715,724,755,764,795,804,835,844,875,884,915,924,955,964,995,1004,1035,1499,1500,1459,1460,1379,1380,1419,1420,1339,1340,1299,1300,1259,1260,1219,1220,1179,1180,1139,1140,1099,1100,1059,1060,1019,1020,979,980,939,940,899,900,819,820,859,860,779,780,739,740,699,700,659,660,619,620,579,580,539,540,499,500,459,460,419,420,379,380,339,340,299,300,259,260,219,220,179,180,139,140,99,100,59,60],
  "No Turning Back":[],
  "Find the Center":[],
  "Fearful Forest": [82,1517,122,1477,162,1437,165,1434,205,1394,245,1354,283,1316,323,1276,363,1236,327,1272,367,1232,407,1192,445,1154,485,1114,525,1074,88,1511,128,1471,168,1431,562,1037,522,1077,602,997,528,1071,568,1031,608,991,210,1389,250,1349,290,1309,644,955,684,915,724,875,686,913,726,873,726,873,766,833,729,870,769,830,809,790,92,1507,132,1467,172,1427,175,1424,175,1424,215,1384,255,1344,293,1306,333,1266,373,1226,97,1502,137,1462,177,1422,220,1379,260,1339,300,1299,298,1301,338,1261,378,1221,416,1183,456,1143,496,1103,410,1189,450,1149,490,1109,493,1106,533,1066,573,1026,652,947,692,907,732,867,575,1024,615,984,655,944,102,1497,142,1457,182,1417,184,1415,224,1375,264,1335,342,1257,382,1217,422,1177,459,1140,499,1100,539,1060,802,797,762,837,682,917,722,877,884,715,924,675,964,635,1004,595,967,632,1007,592,1047,552,1087,512,1082,517,1042,557,1122,477,1162,437,474,1125,434,1165,394,1205,354,1245,317,1282,277,1322,237,1362,197,1402,890,709,930,669,970,629,1010,589,235,1364,195,1404,155,1444,115,1484,1493,106,1453,146,1413,186,1207,392,1247,352,1287,312,1327,272,148,1451,188,1411,228,1371,1488,111,1448,151,1408,191,1210,389,1170,429,1130,469,386,1213,346,1253,306,1293],
  "Cluttered with Chairs":[1487,1512,1444,1475,1330,1349,1287,1312,1491,1508,1325,1354,858,861,663,656,744,735,1056,1063,1222,1217,830,809,908,891,1129,1150,1163,1196,965,994,1008,1031,847,872,763,796,606,633,651,668,411,428,364,395,1173,1186,1335,1344,1498,1501,661,658,416,423,532,547,408,431,521,558,122,157,5,34,247,272,130,149,101,98,295,304,251,268,94,105,300,299,125,154,242,277,1534,1545,1078,1041,958,921,916,883,678,641,754,725,710,689,536,543,934,945,738,741,540,539,550,529,22,17,1440,1479,1321,1358,360,399,484,515,978,981,1338,1341,1051,1068,1086,1113,772,787,333,346,175,184,48,71,1562,1597,1590,1569,1239,1200,799,760,79,40,1367,1392,453,466,204,235,217,222,1412,1427,1576,1583,12,27,329,350,1250,1269,1137,1142,815,824,636,603,1206,1233,486,513,1455,1464,1293,1306,1043,1076,337,342,172,187,127,152,160,199,929,950,727,752,613,626,418,421,972,987,1054,1065,1131,1148,1242,1277,1525,1554,1215,1224,853,866,805,834,609,630,326,353,402,437,43,76,209,230,253,266,96,103,1417,1422,1572,1587,1409,1430,1363,1396,1482,1517,1135,1144,896,903,693,706,322,357,92,107,10,29,683,716,406,433,284,315,927,952,1244,1275,1208,1231,1567,1592,439,400,348,331,840,879,1120,1159],  
  "Haunted Houses":[],
  "Horrible Hallways": [120,159,121,158,122,157,123,156,124,155,8,31,48,71,88,111,128,151,168,191,208,231,248,271,288,311,400,439,401,438,402,437,403,436,404,435,405,434,406,433,407,432,408,431,412,427,372,387,292,307,332,347,252,267,212,227,172,187,132,147,92,107,52,67,12,27,613,626,612,627,611,628,610,629,609,630,608,631,607,632,605,634,606,633,604,635,603,636,602,637,601,638,600,639,497,502,457,462,417,422,377,382,337,342,297,302,257,262,177,182,217,222,137,142,97,102,57,62,17,22,1536,1543,1576,1583,1496,1503,1456,1463,1416,1423,1376,1383,1336,1343,1296,1303,1256,1263,1216,1223,1176,1183,1136,1143,1096,1103,1056,1063,1016,1023,976,983,936,943,896,903,856,863,1440,1479,1441,1478,1442,1477,1443,1476,1444,1475,1445,1474,1446,1473,1447,1472,1448,1471,1449,1470,1450,1469,1451,1468,1411,1428,1371,1388,1331,1348,1291,1308,1290,1309,1289,1310,1288,1311,1287,1312,1286,1313,1285,1314,1284,1315,1283,1316,1243,1276,1203,1236,1163,1196,1123,1156,1124,1155,1125,1154,1126,1153,1127,1152,1128,1151,1129,1150,1130,1149,1131,1148,1132,1147,1092,1107,1052,1067,1012,1027,972,987,932,947,931,948,930,949,929,950,928,951,927,952,926,953,925,954,924,955,884,915,844,875,804,835,764,795,765,794,766,793,767,792,768,791,769,790,770,789,772,787,771,788,773,786,614,625,862,857],
  //"Bad bug": [257,262,258,261,263,256,304,295,345,334,385,374,425,414,465,454,505,494,545,534,584,575,618,621,619,620,655,664,694,705,734,745,774,785,814,825,853,866,893,906,933,946,973,986,1013,1026,1053,1066,1093,1106,1174,1185,1214,1225,1254,1265,1295,1304,1336,1343,1377,1382,1418,1421,1457,1462,1456,1463,1495,1504,1494,1505,215,224,175,184,134,145,133,146,132,147,131,148,130,149,169,190,666,653,667,652,668,651,669,650,630,609,591,568,592,567,593,566,554,525,514,485,475,444,394,365,395,364,435,404,971,988,970,989,969,990,968,991,927,952,926,953,885,914,884,915,843,876,803,836,1213,1226,1212,1227,1211,1228,1209,1230,1210,1229,1248,1271,1247,1272,1286,1313,1325,1354,1364,1395,1363,1396,1362,1397,377,382,417,422,418,421,378,381,1340,1339,1300,1299,1260,1259,1220,1219,1180,1179,1059,1060,1019,1020,938,941,937,942,976,983,1015,1024,218,221,178,181,323,356,284,315,285,314,286,313,366,393,117,82,677,642,1157,1122,1551,1528,142,137],
  "Spiral of Doom": [659,940,660,939,661,938,662,937,663,936,664,935,704,895,744,855,784,815,824,775,735,864,695,904,655,944,615,984,575,1024,535,1064,495,1104,496,1103,497,1102,498,1101,499,1100,500,1099,501,1098,502,1097,503,1096,504,1095,505,1094,506,1093,507,1092,508,1091,548,1051,588,1011,628,971,668,931,708,891,748,851,788,811,828,771,868,731,908,691,948,651,988,611,1028,571,1068,531,1108,491,1148,451,1188,411,1228,371,1268,331,332,1267,333,1266,334,1265,335,1264,336,1263,337,1262,338,1261,339,1260,340,1259,341,1258,342,1257,343,1256,344,1255,345,1254,346,1253,347,1252,348,1251,349,1250,350,1249,351,1248,352,1247,392,1207,432,1167,472,1127,512,1087,552,1047,592,1007,632,967,672,927,712,887,752,847,792,807,832,767,872,727,912,687,952,647,992,607,1032,567,1072,527,1112,487,1152,447,1192,407,1232,367,1272,327,1312,287,1352,247,1392,207,1432,167,1431,168,1430,169,1429,170,1428,171,172,1427,173,1426,174,1425,175,1424,176,1423,177,1422,178,1421,179,1420,180,1419,181,1418,182,1417,183,1416,184,1415,185,1414,186,1413,187,1412,188,1411,189,1410,190,1409,191,1408,192,1407,193,1406,194,1405,195,1404,196,1403,236,1363,276,1323,316,1283,356,1243,396,1203,436,1163,476,1123,516,1083,556,1043,596,1003,636,963,676,923,716,883,756,843,796,803,836,763,876,723,916,683,956,643,996,603,1036,563,1076,523,1116,483,1156,443,1196,403,1236,363,1276,323,1316,283,1356,243,1396,203,1436,163,1476,123,1477,122,1478,121,1478,121,1479,120,900,699,860,739],
  "Chilling Chambers": [777,822,776,823,775,824,774,825,773,826,772,827,771,828,770,829,769,830,768,831,700,899,660,939,620,979,580,1019,540,1059,500,1099,460,1139,420,1179,380,1219,340,1259,728,871,688,911,648,951,608,991,568,1031,528,1071,408,1191,368,1231,328,1271,329,1270,330,1269,331,1268,334,1265,335,1264,336,1263,337,1262,338,1261,339,1260,813,786,853,746,893,706,893,706,933,666,1055,544,1056,543,1057,542,1058,541,1054,545,1053,546,297,1302,257,1342,217,1382,177,1422,137,1462,1463,136,1464,135,1465,134,1468,131,1469,130,1470,129,1471,128,1472,127,1473,126,1272,327,1273,326,1393,206,1433,166,138,1461,139,1460,140,1459,143,1456,144,1455,145,1454,146,1453,186,1413,226,1373,266,1333,386,1213,426,1173,426,1173,466,1133,506,1093,1132,467,1131,468,1128,471,1127,472,1126,473,1125,474,1085,514,1045,554,925,674,885,714,845,754,805,794,765,834,766,833,767,832,147,1452,148,1451,149,1450,434,1165,394,1205,274,1325,234,1365,194,1405,154,1445,153,1446,152,1447,1474,125,1475,124,1476,123,1477,122,1437,162,1397,202,1357,242,1317,282,1277,322,1237,362,1117,482,1077,522,1037,562,997,602,957,642,917,682,877,722,837,762,797,802,757,842,717,882,677,922,597,1002,637,962,157,1442,197,1402,237,1362,277,1322,317,1282,357,1242,397,1202,397,1202,437,1162,477,1122],
  "Fraught Floors": [240,1359,241,1358,242,1357,245,1354,246,1353,247,1352,248,1351,249,1350,250,1349,251,1348,252,1347,253,1346,254,1345,255,1344,256,1343,257,1342,258,1341,259,1340,260,1339,261,1338,262,1337,263,1336,264,1335,265,1334,279,1320,278,1321,277,1322,274,1325,273,1326,272,1327,271,1328,270,1329,269,1330,268,1331,267,1332,266,1333,440,1159,441,1158,442,1157,443,1156,444,1155,445,1154,446,1153,447,1152,448,1151,449,1150,450,1149,451,1148,452,1147,453,1146,454,1145,455,1144,456,1143,459,1140,460,1139,461,1138,462,1137,463,1136,464,1135,465,1134,466,1133,467,1132,468,1131,469,1130,470,1129,471,1128,479,1120,478,1121,477,1122,476,1123,475,1124,474,1125,473,1126,472,1127,640,959,641,958,642,957,645,954,646,953,647,952,679,920,678,921,677,922,674,925,673,926,672,927,671,928,670,929,669,930,668,931,667,932,666,933,665,934,664,935,663,936,662,937,661,938,660,939,659,940,658,941,658,941,657,942,656,943,655,944,654,945,653,946,652,947,651,948,650,949,649,950,648,951,775,824,774,825,773,826,772,827,771,828,770,829,769,830,768,831,767,832,766,833,765,834,764,835,763,836,762,761,838,760,839,1459,140,1499,100,1539,60,1579,20]
}
let ochud = document.createElement('CANVAS')
ochud.width = 80, ochud.height = 80
dungeonAt()

function startOver () {
  MAPINDEX = 1
  HP = 3, COINS = 0, KEYS = 0, LEVEL = 1, SWORDS = 0, LIGHTS = 0, MASKS = 0, VERT = false
  retrocolors = randomPick(colors)//colors[(MAPINDEX)%colors.length]//randomPick([c1,c2,c3,c4,c5])
  dungeonAt()
  showposition()
}

function nextMap () {
  MAPINDEX++
  retrocolors = randomPick(colors)//colors[(MAPINDEX)%colors.length]//randomPick([c1,c2,c3,c4,c5])
  HP = 3, COINS = 0, KEYS = 0, LEVEL = 1, SWORDS = 0, LIGHTS = 0, MASKS = 0, VERT = false
  dungeonAt()
  showposition()
}

function showposition () {
  let hud = document.getElementById("hud")
  let ctx = hud.getContext("2d")
  let occtx = ochud.getContext("2d")
  occtx.fillStyle = '#606060'
  occtx.fillRect(ux/20,uy/20,2,2)
  ctx.drawImage(ochud,0,0,80,80)
  ctx.fillStyle = 'white'
  ctx.fillRect(ux/20,uy/20,2,2)
}

function fullscreen () {
  let el = document.documentElement
  if (document.fullscreenElement)
    document.exitFullscreen()
  else
    el.requestFullscreen()
}

document.addEventListener('keydown', (event)=> {    
   let key = event.key
   if (key === "ArrowLeft" || key === "a")
    left()
  if (key === "ArrowRight" || key === "d")
    right()
  if (key === "ArrowUp" || key === "w")
    up()
  if (key === "ArrowDown" || key === "s")
    down()
});

function printMousePos(event) {
  let screen = document.getElementById("myCanvas")
  const cx = screen.width/2, cy = screen.height/2
  let x = event.clientX, y = event.clientY
  if (cx < x && (x-cx > Math.abs(y-cy)))
    right()
  if (cx > x && (cx-x > Math.abs(y-cy)))
    left()
  if (cy < y && (y-cy > Math.abs(x-cx)))
    down()
  if (cy > y && (cy-y > Math.abs(x-cx)))
    up()
}

document.getElementById("myCanvas").addEventListener("click", printMousePos, true);

function xfromindex (i) {return (i % 40)}
function yfromindex (i) {return Math.floor(i/40)}
function ifromxy (x,y) {return (x+y*40)}
function thingat (i) {return things[i]}

function left () {
  let oc = document.getElementById("OC")
  let ctx = oc.getContext("2d")
  let D = 40
  RIGHT = false
  VERT = false
  if (updateUser(ctx, "l")) {
    ux -= D
    let audio = new Audio('sounds/tap.mp3');
    audio.play();
  }
  refresh (ux,uy)
}

function right () {
  let oc = document.getElementById("OC")
  let ctx = oc.getContext("2d")
  let D = 40
  VERT = false
  RIGHT = true
  if (updateUser(ctx, "r")) {
    ux += D
    let audio = new Audio('sounds/tap.mp3');
    audio.play();
  }
  refresh (ux,uy)
}

function up () {
  let oc = document.getElementById("OC")
  let ctx = oc.getContext("2d")
  let D = 40
  VERT = true
  UP = true
  if (updateUser(ctx, "u")) {
    uy -= D
    let audio = new Audio('sounds/tap.mp3');
    audio.play();
  }
  refresh (ux,uy)
}

function down () {
  let oc = document.getElementById("OC")
  let ctx = oc.getContext("2d")
  let D = 40
  VERT = true
  UP = false
  if (updateUser(ctx, "d")) {
    uy += D
    let audio = new Audio('sounds/tap.mp3');
    audio.play();
  }
  refresh (ux,uy)
}

function updateUser(ctx, dir) {
  let oc = document.getElementById("OC")
  let W = oc.width
  if (HP < 1) {
    message ("GAME OVER.")
    let audio = new Audio('sounds/gameover.mp3')
      audio.play()
    LIGHTS = 1
    refresh()
    return
  }
  let D = 40, 
  i = 0, DX = 0, DY = 0
  if (dir === "d")
    DY += D
  if (dir === "u")
    DY -= D
  if (dir === "r")
    DX += D
  if (dir === "l")
    DX -= D
  let iu = ifromxy ((ux)/40,(uy)/40)
  i = ifromxy ((ux+DX)/40,(uy+DY)/40)
  if (yfromindex(i) < 0 || yfromindex(i) > 39)
    return false
  if (ux+DX < 0 || ux+DX > W-40) // 760
    return false
  let t = thingat(i)
  if (t === "stairsAt") {
    // next level
    LEVEL += 1
    MAPINDEX += 1
    let k = Object.keys(Maps)
    MAP = k[(MAPINDEX-1)%k.length]
    message("LEVEL "+LEVEL+": "+MAP)
    let audio = new Audio('sounds/tada.mp3')
      audio.play()
    dungeonAt()
    return
  }
  if (t === "bulbAt") {
    if (COINS < 5 && LIGHTS < 1) {
      message("You need 5 coins to turn on the lights.")
    } else 
    if (COINS > 4 && LIGHTS < 1) {
      let audio = new Audio('sounds/switch.mp3')
        audio.play()
      message("5 coins deducted.")
      COINS -= 5
      LIGHTS = 1
      // delete bulb 
      things[i] = "dotAt"
      ctx.fillStyle = retrocolors[3]//"black"
      ctx.fillRect(ux+DX,uy+DY,D,D)
      //dotAt(ux+DX,uy+DY,D,'white')
      return
    }
  }
  if (t === "treasureAt") {
    if (KEYS < 1)
      message("You need the key to open this.")
    else {
      message("You find 5 coins!")
      let audio = new Audio('sounds/coin.mp3')
      audio.play()
      COINS += 5
      things[i] = "dotAt"
      //ctx.fillStyle = "black"
      ctx.fillStyle = retrocolors[3]
      ctx.fillRect(ux+DX,uy+DY,D,D)
      dotAt(ux+DX,uy+DY,D,'white')
      return
    }
  }
  if (unmovables.includes(thingat(i))) {
    return false
  }
  processthing(t)
  ctx.fillStyle = retrocolors[3]//'black'
  ctx.fillRect(ux,uy,D,D)
  ctx.fillRect(ux+DX,uy+DY,D,D)
  if (MAP === "No Turning Back") {
    console.log(ux,uy)
    console.log(THETHING)
    things[iu] = THETHING
    window [things[iu]] (ux+1,uy+1,D-2,'white')
    //filledAt (ux*40,uy*40,D,'white') 
  }
  if (consumables.includes(t)) {
   // dotAt(ux,uy,D,'white')
    things[ifromxy ((ux+DX)/40,(uy+DY)/40)] = "dotAt"
  } else
    window [t] (ux,uy,D,'white') 
  userAt(ux+DX+1,uy+DY+1,D-2,'white')
  
if (MAP !== "No Turning Back")
  things[iu] = "dotAt"
  return true
}

function refresh (ux,uy) {
  let oc = document.getElementById("OC")
  let ctx = oc.getContext("2d")
  let screen = document.getElementById("myCanvas")
  let sctx = screen.getContext("2d")
  let W = oc.width
  let Wd = screen.width
  let D = 40//W/20
  let pad = 200//W/4
  let i = 0, r = 3*D
  sctx.globalAlpha = 1
  sctx.fillStyle = retrocolors[4]
  sctx.fillRect(0,0,screen.width, screen.height)
  sctx.globalAlpha = 0.1
  sctx.fillStyle = retrocolors[4]
  for (; i < 9; i++) {
    sctx.save()
    sctx.beginPath()
    sctx.arc(pad+20, pad+20, r, 0, Math.PI*2)
    sctx.closePath()
    sctx.clip()
    sctx.drawImage(oc,pad-ux,pad-uy,W,W)
    sctx.restore()
    r += 9//*= 0.6
  }
  sctx.fillStyle = retrocolors[4]
  sctx.globalAlpha = 1
  if (LIGHTS > 0)
    sctx.drawImage(oc,pad-ux,pad-uy,W,W)
  statusbar()
  showposition()
}

function processthing (t) {
  if (t === "coinAt" || (t === "treasure" && KEYS > 0)) {
    COINS++
    let audio = new Audio('sounds/coin.mp3')
    audio.play()
  }
  if (t === "virusAt") {
    if (MASKS > 0)
      return
    let audio = new Audio('sounds/jump.mp3')
    audio.play() 
    HP--
    // replace 4 dots with virusAt
    let s = [], max = 4, ct = 0
    let i = 0
    for (;i < 1600; i++)
      s[i] = i
    shuffleArray(s)
    i = 0
    for (; i < s.length; i++) {
      let t = thingat(s[i])
      if (t === "dotAt") {
        things[s[i]] = "virusAt"
        virusAt(xfromindex(s[i])*40, yfromindex(s[i])*40, 40, "white")
        ct++
        if (ct >= 4)
          break
      }
    }
  }
  if (t === "monsterAt") {
    if (COINS > 0) {
      let deducted = Math.round (COINS/2)
      let audio = new Audio('sounds/hurt1.mp3')
      audio.play()
      if (COINS > 1)
        message("The monster stole "+deducted+" coins.")
      else
        message("The monster stole "+deducted+" coin.")
      COINS -= deducted
      
    } else {
      message("I'll get you next time.")
    }
    // swap one dotAt for the monsterAt
    let s = []
    let i = 0
    for (;i < 1600; i++)
      s[i] = i
    shuffleArray(s)
    i = 0
    for (; i < s.length; i++) {
      let t = thingat(s[i])
      if (t === "dotAt") {
        things[s[i]] = "monsterAt"
        //console.log(things[s[i]],xfromindex(s[i]), yfromindex(s[i]),)
        monsterAt(xfromindex(s[i])*40, yfromindex(s[i])*40, 40, "white")
        break
      }
    }
  }
  if (t === "heartAt" || t === "flaskAt") {
    HP++
    let audio = new Audio('sounds/pop.mp3')
    audio.play()
  }
  if (t === "ghostAt" || t === "spiderAt" || t === "skullAt") {
    if (HITS > 0) {
    let audio = new Audio('sounds/swish.mp3')
    audio.play()
      HITS--
      if (HITS < 1) {
        SWORDS = 0
        message("Your sword has broken!\n")
      }
      return
    }
    let audio = new Audio('sounds/hurt1.mp3')
    audio.play()
    HP--
    if (t === "spiderAt")
      HP--
    if (t === "skullAt")
      HP -= 2
    if (HP < 1) {
      message("GAME OVER.")
      let audio = new Audio('sounds/gameover.mp3')
        audio.play()
      LIGHTS = 1
      refresh()
    }
  }
  if (t === "maskAt") {
    message("You found a mask!\n")
    MASKS = 1
    let audio = new Audio('sounds/find.mp3')
    audio.play()
    return
  }
  if (t === "keyAt") {
    message("You found a key!\n")
    KEYS = 1
    let audio = new Audio('sounds/find.mp3')
    audio.play()
    return
  }
  if (t === "swordAt") {
    message("You found a sword!\n")
    HITS += 5
    let audio = new Audio('sounds/sword.mp3')
    audio.play()
    SWORDS = 1
    return
  }
}

function dungeonAt () {
  let oc = document.getElementById("OC")
  let ctx = oc.getContext("2d")
  let screen = document.getElementById("myCanvas")
  let sctx = screen.getContext("2d")
  let hudctx = ochud.getContext("2d")
  retrocolors = randomPick(colors)//colors[(MAPINDEX)%colors.length]
  THETHING = randomPick(["filledAt", "ghostAt","spiderAt", "virusAt"])
  hudctx.fillStyle = 'black'
  hudctx.fillRect(0,0,80,80)
  KEYS = 0, MASKS = 0, LIGHTS = 0
  if (HP < 1)
    HP += 3
  let x = 0, y = 0, color = 'white'
  let W = oc.width, H = W, cpx, cpy
  sctx.lineWidth = 1
  ctx.fillStyle = retrocolors[3]//'black'
  ctx.fillRect(0,0,1600,1600)
  ctx.strokeStyle = color
  ctx.fillStyle = color
  ctx.font = "9pt"
  let G = W/40, D = 40//W/G
  let N = 1600//G*G
  let k = Object.keys(Maps)
  console.log(MAPINDEX)
  MAP = k[(MAPINDEX-1)%k.length]
  let map = Maps[k[(MAPINDEX-1)%k.length]]
  let i = 0, dx = 0, dy = 0
  things = new Array(N)
  let idx = new Array(N)
  i = 0
  for (; i < N; i++) {  // all dots
    idx[i] = i
    things[i] = "dotAt"
  }
  // pack central square w/ things
  let x2 = 3, y2 = 3
  if (MAP === "Find the Center") {
    for (; x2 < 37; x2++) {
      for (; y2 < 37; y2++) {
        things[ifromxy(x2, y2)] = randomPick(["spiderAt", "spiderAt","spiderAt","spiderAt","spiderAt", "skullAt", "ghostAt", "heartAt"])
      }
      y2 = 3
    }
    listThings()
  }
  // end pack
  
  message("LEVEL "+LEVEL+": "+MAP)
  i = 0
  if (MAP !== "Find the Center" && MAP !== "Haunted Houses")
    for (; i < map.length; i++) {
      things[map[i]] = "filledAt"
      idx = idx.filter(function(item) {return item !== map[i]})
    }
  if (MAP === "Haunted Houses") {
    i = 0
    for (; i < 1600; i++) {
    if (i % 6 === 0 | i % 11 === 4) {
      things[i] = "filledAt"
      idx = idx.filter(function(item) {return item !== i})
      }
    }
  }
  let user = 680, stairs = 719
  if (MAP === "Find the Center")
    stairs = 780
  if (MAP === "The snake") {
    user = 1560
    stairs = 1599
  }
  if (MAP === "Diagonal") {
    user = 1560, stairs = 39
  }
  if (MAP === "Awful Attic") {
    user = 1560
    stairs = 600
  }
    
  things[user] = "userAt"
  idx = idx.filter(function(item) {return item !== user})
  things[stairs] = "stairsAt"
  idx = idx.filter(function(item) {return item !== stairs})
  shuffleArray(idx)
  if (MAP !== "Find the Center") {
    i = 0
    for (; i < 35; i++) {
      things[idx[i]] = "ghostAt"
    }
    for (; i < 40; i++) {
      things[idx[i]] = "spiderAt"
    }
    for (; i < 45; i++) {
      things[idx[i]] = "coinAt"
    }
    for (; i < 50; i++) {
      things[idx[i]] = "heartAt"
    }
    for (; i < 55; i++) {
      things[idx[i]] = "flaskAt"
    } 
    for (; i < 65; i++) {
      things[idx[i]] = "virusAt"
    }
    if (LEVEL > 2)
      things[idx[i++]] = "swordAt"
    things[idx[i++]] = "keyAt"
    things[idx[i++]] = "treasureAt"
    things[idx[i++]] = "bulbAt"
    things[idx[i++]] = "bulbAt"
    things[idx[i++]] = "maskAt"

    things[idx[i++]] = "monsterAt"
    if (LEVEL > 2)
      things[idx[i++]] = "monsterAt"
    things[idx[i++]] = "monsterAt"
    let max = i + 90
    max += i + (20 * LEVEL)
    for (; i < max; i++) {
      if (Math.random() > 0.1) {
        if (Math.random() > 0.5)
          things[idx[i]] = "spiderAt"
        else
          things[idx[i]] = "ghostAt"
      } else  
      if (LEVEL > 2)
        things[idx[i]] = "skullAt" 
    }
  }
  i = 0, dy = 0, dx = 0
  ctx.globalAlpha = 1
  listThings()
  for (; i < 1600; i++) {
    if (i > 0 && i % 40 === 0) {
      dx = 0
      dy += D
    }
    let f = things[i]
    if (f === "userAt") {
      ux = x + dx
      uy = y + dy
    }
    window [things[i]] (x+dx+1,y+dy+1,D-2,color)
    dx += D
  }
  refresh(ux,uy)
}

function listThings () {
  let set = new Set (), i = 0
  for  (; i < things.length;i++) {
    set[things[i]] = (set[things[i]]+1 || 1)
  }
  console.log(set)
}

function virusAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy
  ctx.strokeStyle = color
  ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  let d = 22
  ctx.beginPath()
  ctx.moveTo(x+12*W/d, y+18*H/d)
  cpx = x+18*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/d, y+12*H/d)
  cpx = x+18*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+6*H/d)
  cpx = x+6*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/d, y+12*H/d)
  cpx = x+6*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+18*H/d)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+12*W/d, y+6*H/d)
  cpx = x+11*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+11*W/d, y+5*H/d)
  cpx = x+11*W/d
  cpy = y+4*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+4*H/d)
  cpx = x+13*W/d
  cpy = y+4*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/d, y+5*H/d)
  cpx = x+13*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+6*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+18*W/d, y+12*H/d)
  cpx = x+18*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+19*W/d, y+13*H/d)
  cpx = x+20*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/d, y+12*H/d)
  cpx = x+20*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+19*W/d, y+11*H/d)
  cpx = x+18*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/d, y+12*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+16*W/d, y+7*H/d)
  cpx = x+16*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/d, y+6*H/d)
  cpx = x+18*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/d, y+7*H/d)
  cpx = x+18*W/d
  cpy = y+8*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/d, y+8*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+12*W/d, y+18*H/d)
  cpx = x+13*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/d, y+19*H/d)
  cpx = x+13*W/d
  cpy = y+20*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+20*H/d)
  cpx = x+11*W/d
  cpy = y+20*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+11*W/d, y+19*H/d)
  cpx = x+11*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+18*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+6*W/d, y+12*H/d)
  cpx = x+6*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+5*W/d, y+13*H/d)
  cpx = x+4*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/d, y+12*H/d)
  cpx = x+4*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+5*W/d, y+11*H/d)
  cpx = x+6*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/d, y+12*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+7*W/d, y+8*H/d)
  cpx = x+6*W/d
  cpy = y+8*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/d, y+7*H/d)
  cpx = x+6*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/d, y+6*H/d)
  cpx = x+8*W/d
  cpy = y+6*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/d, y+7*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+7*W/d, y+16*H/d)
  cpx = x+6*W/d
  cpy = y+16*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/d, y+17*H/d)
  cpx = x+6*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/d, y+18*H/d)
  cpx = x+8*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/d, y+17*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+16*W/d, y+17*H/d)
  cpx = x+16*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/d, y+18*H/d)
  cpx = x+18*W/d
  cpy = y+18*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/d, y+17*H/d)
  cpx = x+18*W/d
  cpy = y+16*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/d, y+16*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+12*W/d, y+13*H/d)
  cpx = x+11*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+11*W/d, y+12*H/d)
  cpx = x+11*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+11*H/d)
  cpx = x+13*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/d, y+12*H/d)
  cpx = x+13*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+13*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+12*W/d, y+9*H/d)
  cpx = x+11*W/d
  cpy = y+9*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+11*W/d, y+8*H/d)
  cpx = x+11*W/d
  cpy = y+7*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+7*H/d)
  cpx = x+13*W/d
  cpy = y+7*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/d, y+8*H/d)
  cpx = x+13*W/d
  cpy = y+9*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+9*H/d)
  cpx = x+16*W/d
  cpy = y+11*H/d
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+16*W/d, y+11*H/d)
  cpx = x+15*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/d, y+10*H/d)
  cpx = x+15*W/d
  cpy = y+9*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/d, y+9*H/d)
  cpx = x+17*W/d
  cpy = y+9*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/d, y+10*H/d)
  cpx = x+17*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/d, y+11*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+16*W/d, y+15*H/d)
  cpx = x+15*W/d
  cpy = y+15*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/d, y+14*H/d)
  cpx = x+15*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/d, y+13*H/d)
  cpx = x+17*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/d, y+14*H/d)
  cpx = x+17*W/d
  cpy = y+15*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/d, y+15*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+8*W/d, y+11*H/d)
  cpx = x+7*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/d, y+10*H/d)
  cpx = x+7*W/d
  cpy = y+9*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/d, y+9*H/d)
  cpx = x+9*W/d
  cpy = y+9*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/d, y+10*H/d)
  cpx = x+9*W/d
  cpy = y+11*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/d, y+11*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+8*W/d, y+13*H/d)
  cpx = x+9*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/d, y+14*H/d)
  cpx = x+9*W/d
  cpy = y+15*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/d, y+15*H/d)
  cpx = x+7*W/d
  cpy = y+15*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/d, y+14*H/d)
  cpx = x+7*W/d
  cpy = y+13*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/d, y+13*H/d)
  ctx.fill()

  ctx.beginPath()
  ctx.moveTo(x+12*W/d, y+17*H/d)
  cpx = x+11*W/d
  cpy = y+17*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+11*W/d, y+16*H/d)
  cpx = x+11*W/d
  cpy = y+15*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+15*H/d)
  cpx = x+13*W/d
  cpy = y+15*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/d, y+16*H/d)
  cpx = x+13*W/d
  cpy = y+17*H/d
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/d, y+17*H/d)
  ctx.fill()
}

function bulbAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy

  ctx.strokeStyle = 'yellow'
  ctx.fillStyle = 'white'

  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  ctx.lineWidth = 2
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+22*H/24)
  cpx = x+10*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+20*H/24)
  cpx = x+10*W/24
  cpy = y+17*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+17*H/24)
  cpx = x+10*W/24
  cpy = y+14*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/24, y+12*H/24)
  cpx = x+5*W/24
  cpy = y+11*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+5*W/24, y+8*H/24)
  cpx = x+5*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+2*H/24)
  cpx = x+19*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+19*W/24, y+8*H/24)
  cpx = x+19*W/24
  cpy = y+11*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/24, y+12*H/24)
  cpx = x+14*W/24
  cpy = y+14*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+17*H/24)
  cpx = x+14*W/24
  cpy = y+20*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+20*H/24)
  cpx = x+14*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+22*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+10*W/24, y+18*H/24)
  ctx.lineTo(x+14*W/24, y+18*H/24)
  ctx.lineTo(x+14*W/24, y+19*H/24)
  ctx.lineTo(x+10*W/24, y+19*H/24)
  ctx.lineTo(x+10*W/24, y+20*H/24)
  ctx.lineTo(x+14*W/24, y+20*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+11*W/24, y+18*H/24)
  cpx = x+10*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+11*H/24)
  ctx.lineTo(x+11*W/24, y+9*H/24)
  ctx.lineTo(x+11*W/24, y+11*H/24)
  ctx.lineTo(x+12*W/24, y+9*H/24)
  ctx.lineTo(x+12*W/24, y+11*H/24)
  ctx.lineTo(x+13*W/24, y+9*H/24)
  ctx.lineTo(x+13*W/24, y+11*H/24)
  ctx.lineTo(x+14*W/24, y+9*H/24)
  ctx.lineTo(x+14*W/24, y+10*H/24)
  ctx.lineTo(x+13*W/24, y+18*H/24)
  ctx.stroke()
}

function swordAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.lineWidth = 2
  ctx.strokeStyle = color
  ctx.fillStyle = 'yellow'
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+0*W/24, y+24*H/24)
  ctx.lineTo(x+8*W/24, y+22*H/24)
  ctx.lineTo(x+16*W/24, y+12*H/24)
  ctx.lineTo(x+12*W/24, y+8*H/24)
  ctx.lineTo(x+2*W/24, y+16*H/24)
  ctx.lineTo(x+0*W/24, y+24*H/24)
  ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+8*H/24)
  ctx.lineTo(x+10*W/24, y+6*H/24)
  ctx.lineTo(x+12*W/24, y+4*H/24)
  ctx.lineTo(x+20*W/24, y+12*H/24)
  ctx.lineTo(x+18*W/24, y+14*H/24)
  ctx.lineTo(x+16*W/24, y+12*H/24)
  ctx.fill()
  ctx.stroke()

  //3
  ctx.beginPath()
  ctx.moveTo(x+14*W/24, y+6*H/24)
  ctx.lineTo(x+18*W/24, y+2*H/24)
  cpx = x+20*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+2*H/24)
  cpx = x+24*W/24
  cpy = y+4*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+6*H/24)
  cpx = x+18*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/24, y+10*H/24)
  cpx = x+14*W/24
  cpy = y+6*H/24
  ctx.fill()
  ctx.stroke()
}

function openedAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+2*W/24, y+6*H/24)
  ctx.lineTo(x+2*W/24, y+19*H/24)
  ctx.lineTo(x+6*W/24, y+23*H/24)
  ctx.lineTo(x+23*W/24, y+23*H/24)
  ctx.lineTo(x+23*W/24, y+10*H/24)
  ctx.lineTo(x+6*W/24, y+10*H/24)
  ctx.lineTo(x+2*W/24, y+6*H/24)
  ctx.stroke()
  //2
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+23*H/24)
  ctx.lineTo(x+6*W/24, y+10*H/24)
  ctx.stroke()
  //3
  ctx.beginPath()
  ctx.moveTo(x+2*W/24, y+6*H/24)
  ctx.lineTo(x+19*W/24, y+6*H/24)
  ctx.lineTo(x+23*W/24, y+10*H/24)
  ctx.stroke()

  //4
  ctx.beginPath()
  ctx.moveTo(x+2*W/24, y+6*H/24)
  ctx.lineTo(x+6*W/24, y+2*H/24)
  ctx.lineTo(x+22*W/24, y+2*H/24)
  ctx.lineTo(x+23*W/24, y+2*H/24)
  ctx.lineTo(x+19*W/24, y+6*H/24)
  ctx.stroke()

  //5
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+12*H/24)
  ctx.lineTo(x+18*W/24, y+20*H/24)
  ctx.stroke()

  //6
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+20*H/24)
  ctx.lineTo(x+18*W/24, y+12*H/24)
  ctx.stroke()

  //7
  ctx.beginPath()
  ctx.moveTo(x+2*W/24, y+6*H/24)
  cpx = x+2*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+2*H/24)
  ctx.stroke()
}

function stairsAt (x,y,W,color,n) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W
  ctx.strokeStyle = color
  ctx.fillStyle = "#daa520"
  ctx.lineWidth = 2
  ctx.lineCap = "butt"
  ctx.lineJoin = "round"
//10
  ctx.beginPath()
  ctx.moveTo(x+1*W/24, y+16*H/24)
  ctx.lineTo(x+8*W/24, y+23*H/24)
  ctx.lineTo(x+23*W/24, y+23*H/24)
  ctx.lineTo(x+23*W/24, y+8*H/24)
  ctx.lineTo(x+16*W/24, y+1*H/24)
  ctx.lineTo(x+11*W/24, y+1*H/24)
  ctx.lineTo(x+11*W/24, y+6*H/24)
  ctx.lineTo(x+6*W/24, y+6*H/24)
  ctx.lineTo(x+6*W/24, y+11*H/24)
  ctx.lineTo(x+1*W/24, y+11*H/24)
  ctx.fill()
  ctx.stroke()
  //1
  ctx.beginPath()
  ctx.moveTo(x+8*W/24, y+23*H/24)
  ctx.lineTo(x+8*W/24, y+18*H/24)
  ctx.lineTo(x+13*W/24, y+18*H/24)
  ctx.lineTo(x+13*W/24, y+13*H/24)
  ctx.lineTo(x+18*W/24, y+13*H/24)
  ctx.lineTo(x+18*W/24, y+8*H/24)
  ctx.lineTo(x+23*W/24, y+8*H/24)
  ctx.lineTo(x+23*W/24, y+23*H/24)
  ctx.lineTo(x+8*W/24, y+23*H/24)
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+8*W/24, y+23*H/24)
  ctx.lineTo(x+1*W/24, y+16*H/24)
  ctx.stroke()

  //3
  ctx.beginPath()
  ctx.moveTo(x+8*W/24, y+18*H/24)
  ctx.lineTo(x+1*W/24, y+11*H/24)
  ctx.stroke()

  //4
  ctx.beginPath()
  ctx.moveTo(x+1*W/24, y+11*H/24)
  ctx.lineTo(x+6*W/24, y+11*H/24)
  ctx.lineTo(x+6*W/24, y+6*H/24)
  ctx.lineTo(x+11*W/24, y+6*H/24)
  ctx.lineTo(x+11*W/24, y+1*H/24)
  ctx.lineTo(x+16*W/24, y+1*H/24)
  ctx.lineTo(x+23*W/24, y+8*H/24)
  ctx.stroke()

  //5
  ctx.beginPath()
  ctx.moveTo(x+11*W/24, y+1*H/24)
  ctx.lineTo(x+18*W/24, y+8*H/24)
  ctx.stroke()

  //6
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+6*H/24)
  ctx.lineTo(x+13*W/24, y+13*H/24)
  ctx.stroke()

  //7
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+11*H/24)
  ctx.lineTo(x+13*W/24, y+18*H/24)
  ctx.stroke()

  //8
  ctx.beginPath()
  ctx.moveTo(x+11*W/24, y+6*H/24)
  ctx.lineTo(x+18*W/24, y+13*H/24)
  ctx.stroke()

  //9
  ctx.beginPath()
  ctx.moveTo(x+1*W/24, y+11*H/24)
  ctx.lineTo(x+1*W/24, y+16*H/24)
  ctx.stroke()

  
}

function keyAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = color
  ctx.strokeStyle = "yellow"
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  ctx.lineWidth = 3
  //1
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+6*H/24)
  cpx = x+15*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+3*H/24)
  cpx = x+15*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+0*H/24)
  cpx = x+9*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+3*H/24)
  cpx = x+9*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+6*H/24)
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+6*H/24)
  ctx.lineTo(x+12*W/24, y+23*H/24)
  ctx.stroke()

  //3
  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+17*H/24)
  ctx.lineTo(x+15*W/24, y+23*H/24)
  ctx.stroke()

  //4
  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+20*H/24)
  ctx.lineTo(x+12*W/24, y+20*H/24)
  ctx.stroke()

  //5
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+8*H/24)
  cpx = x+12*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+6*H/24)
  cpx = x+8*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+8*H/24)
  cpx = x+8*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+10*H/24)
  cpx = x+12*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+8*H/24)
  cpx = x+12*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+6*H/24)
  cpx = x+16*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+8*H/24)
  cpx = x+16*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+10*H/24)
  cpx = x+12*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+8*H/24)
  ctx.stroke()
}

function maskAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.fillStyle = "#ffffff"
  ctx.strokeStyle = "#ff6666"
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
   //1
  //1
  ctx.beginPath()
  ctx.moveTo(x+4*W/24, y+16*H/24)
  cpx = x+6*W/24
  cpy = y+19*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+19*H/24)
  cpx = x+18*W/24
  cpy = y+19*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+16*H/24)
  ctx.lineTo(x+20*W/24, y+8*H/24)
  ctx.lineTo(x+12*W/24, y+5*H/24)
  ctx.lineTo(x+4*W/24, y+8*H/24)
  ctx.lineTo(x+4*W/24, y+16*H/24)
  ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+5*W/24, y+12*H/24)
  ctx.lineTo(x+19*W/24, y+12*H/24)
  ctx.stroke()

  //3
  ctx.beginPath()
  ctx.moveTo(x+5*W/24, y+10*H/24)
  cpx = x+9*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+8*H/24)
  cpx = x+15*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+19*W/24, y+10*H/24)
  ctx.stroke()

  //4
  ctx.beginPath()
  ctx.moveTo(x+19*W/24, y+14*H/24)
  cpx = x+15*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+16*H/24)
  cpx = x+9*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+5*W/24, y+14*H/24)
  ctx.stroke()

  //5
  ctx.beginPath()
  ctx.moveTo(x+4*W/24, y+8*H/24)
  cpx = x+1*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+1*W/24, y+12*H/24)
  cpx = x+1*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+16*H/24)
  ctx.stroke()

  //6
  ctx.beginPath()
  ctx.moveTo(x+20*W/24, y+16*H/24)
  cpx = x+23*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+23*W/24, y+12*H/24)
  cpx = x+23*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+8*H/24)
  ctx.stroke()
}

function heartAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.lineWidth = 2
  ctx.strokeStyle = "#ffffff"
  ctx.fillStyle = "#ff6666"
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"

  //1
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+22*H/24)
  cpx = x+22*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+8*H/24)
  cpx = x+22*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/24, y+2*H/24)
  cpx = x+12*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+8*H/24)
  cpx = x+12*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/24, y+2*H/24)
  cpx = x+2*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+8*H/24)
  cpx = x+2*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+22*H/24)
  ctx.fill()
  ctx.stroke()
}

function userAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W
  ctx.globalAlpha = 1
  ctx.lineWidth = 2
  let hip = W * 0.8
  ctx.lineJoin = "round"
  ctx.fillStyle = color
  ctx.strokeStyle = 'white'
  ctx.fillStyle = "#ec7d00"
  if (HP > 4)
    ctx.fillStyle = "green"
  else  
  if (HP < 2)
    ctx.fillStyle = "red"
  if (!VERT) {
    if (RIGHT)
      figureRAt(x,y,W,ctx.fillStyle)
    else
      figureLAt(x,y,W,ctx.fillStyle)
  } else {
  if (UP)
      /*figureUAt*/figureRUAt(x,y,W,ctx.fillStyle)
    else
      /*figureDAt*/figureRDAt(x,y,W,ctx.fillStyle)
  }
  return
}

function figureRDAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy
  ctx.strokeStyle = 'white'
  ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+18*W/24, y+12*H/24)
  cpx = x+18*W/24
  cpy = y+9*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+21*W/24, y+9*H/24)
  cpx = x+24*W/24
  cpy = y+9*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+24*W/24, y+12*H/24)
  cpx = x+24*W/24
  cpy = y+15*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+21*W/24, y+15*H/24)
  cpx = x+18*W/24
  cpy = y+15*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/24, y+12*H/24)
  ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+18*W/24, y+17*H/24)
  ctx.lineTo(x+18*W/24, y+8*H/24)
  ctx.lineTo(x+14*W/24, y+3*H/24)
  ctx.lineTo(x+11*W/24, y+7*H/24)
  ctx.lineTo(x+13*W/24, y+8*H/24)
  ctx.lineTo(x+14*W/24, y+7*H/24)
  ctx.lineTo(x+15*W/24, y+8*H/24)
  ctx.lineTo(x+13*W/24, y+8*H/24)
  ctx.lineTo(x+11*W/24, y+7*H/24)
  ctx.lineTo(x+2*W/24, y+4*H/24)
  ctx.lineTo(x+2*W/24, y+9*H/24)
  ctx.lineTo(x+8*W/24, y+12*H/24)
  ctx.lineTo(x+2*W/24, y+16*H/24)
  ctx.lineTo(x+4*W/24, y+20*H/24)
  ctx.lineTo(x+11*W/24, y+16*H/24)
  ctx.lineTo(x+15*W/24, y+16*H/24)
  ctx.lineTo(x+12*W/24, y+18*H/24)
  ctx.lineTo(x+10*W/24, y+22*H/24)
  ctx.lineTo(x+13*W/24, y+23*H/24)
  ctx.lineTo(x+14*W/24, y+20*H/24)
  ctx.lineTo(x+18*W/24, y+17*H/24)
  ctx.fill()
  ctx.stroke()
}

function figureRUAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = 'white'
  ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+16*W/24, y+12*H/24)
  ctx.lineTo(x+22*W/24, y+8*H/24)
  ctx.lineTo(x+20*W/24, y+4*H/24)
  ctx.lineTo(x+13*W/24, y+8*H/24)
  ctx.lineTo(x+9*W/24, y+8*H/24)
  ctx.lineTo(x+12*W/24, y+6*H/24)
  ctx.lineTo(x+14*W/24, y+2*H/24)
  ctx.lineTo(x+11*W/24, y+1*H/24)
  ctx.lineTo(x+10*W/24, y+4*H/24)
  ctx.lineTo(x+6*W/24, y+7*H/24)
  ctx.lineTo(x+6*W/24, y+16*H/24)
  ctx.lineTo(x+10*W/24, y+21*H/24)
  ctx.lineTo(x+13*W/24, y+17*H/24)
  ctx.lineTo(x+11*W/24, y+16*H/24)
  ctx.lineTo(x+9*W/24, y+16*H/24)
  ctx.lineTo(x+10*W/24, y+17*H/24)
  ctx.lineTo(x+11*W/24, y+16*H/24)
  ctx.lineTo(x+13*W/24, y+17*H/24)
  ctx.lineTo(x+22*W/24, y+20*H/24)
  ctx.lineTo(x+22*W/24, y+15*H/24)
  ctx.lineTo(x+16*W/24, y+12*H/24)
  ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+12*H/24)
  cpx = x+6*W/24
  cpy = y+15*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+3*W/24, y+15*H/24)
  cpx = x+0*W/24
  cpy = y+15*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+0*W/24, y+12*H/24)
  cpx = x+0*W/24
  cpy = y+9*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+3*W/24, y+9*H/24)
  cpx = x+6*W/24
  cpy = y+9*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+12*H/24)
  ctx.fill()
  ctx.stroke()
}

function spiderAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  ctx.lineWidth = 2

  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+22*H/24)
  cpx = x+6*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+16*H/24)
  cpx = x+6*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+12*H/24)
  cpx = x+18*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/24, y+16*H/24)
  cpx = x+18*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+22*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+12*H/24)
  cpx = x+15*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+10*H/24)
  cpx = x+15*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+7*H/24)
  cpx = x+9*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+10*H/24)
  cpx = x+9*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+12*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+10*W/24, y+8*H/24)
  ctx.lineTo(x+8*W/24, y+6*H/24)
  ctx.lineTo(x+8*W/24, y+3*H/24)
  ctx.lineTo(x+11*W/24, y+2*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+9*W/24, y+9*H/24)
  ctx.lineTo(x+6*W/24, y+8*H/24)
  ctx.lineTo(x+4*W/24, y+3*H/24)
  ctx.lineTo(x+7*W/24, y+1*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+9*W/24, y+10*H/24)
  ctx.lineTo(x+3*W/24, y+10*H/24)
  ctx.lineTo(x+2*W/24, y+15*H/24)
  ctx.lineTo(x+3*W/24, y+19*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+9*W/24, y+11*H/24)
  ctx.lineTo(x+4*W/24, y+12*H/24)
  ctx.lineTo(x+4*W/24, y+17*H/24)
  ctx.lineTo(x+6*W/24, y+21*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+11*H/24)
  ctx.lineTo(x+20*W/24, y+12*H/24)
  ctx.lineTo(x+20*W/24, y+17*H/24)
  ctx.lineTo(x+18*W/24, y+21*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+10*H/24)
  ctx.lineTo(x+21*W/24, y+10*H/24)
  ctx.lineTo(x+22*W/24, y+15*H/24)
  ctx.lineTo(x+21*W/24, y+19*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+9*H/24)
  ctx.lineTo(x+18*W/24, y+8*H/24)
  ctx.lineTo(x+20*W/24, y+3*H/24)
  ctx.lineTo(x+17*W/24, y+1*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+14*W/24, y+8*H/24)
  ctx.lineTo(x+16*W/24, y+6*H/24)
  ctx.lineTo(x+16*W/24, y+3*H/24)
  ctx.lineTo(x+13*W/24, y+2*H/24)
  ctx.stroke()
}

function monsterAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.lineWidth = 2
  ctx.strokeStyle = "orange"
  ctx.fillStyle = 'orange'
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  let r = ctx.lineWidth
  ctx.beginPath()
  ctx.moveTo(x+8*W/24, y+14*H/24)
  ctx.lineTo(x+9*W/24, y+16*H/24)
  ctx.lineTo(x+10*W/24, y+14*H/24)
  ctx.lineTo(x+11*W/24, y+16*H/24)
  ctx.lineTo(x+12*W/24, y+14*H/24)
  ctx.lineTo(x+13*W/24, y+16*H/24)
  ctx.lineTo(x+14*W/24, y+14*H/24)
  ctx.lineTo(x+15*W/24, y+16*H/24)
  ctx.lineTo(x+16*W/24, y+14*H/24)
  ctx.lineTo(x+17*W/24, y+16*H/24)
  ctx.lineTo(x+18*W/24, y+14*H/24)
  ctx.lineTo(x+19*W/24, y+16*H/24)
  ctx.lineTo(x+20*W/24, y+14*H/24)
  ctx.lineTo(x+8*W/24, y+14*H/24)
  cpx = x+7*W/24
  cpy = y+14*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+7*W/24, y+15*H/24)
  cpx = x+7*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+16*H/24)
  ctx.lineTo(x+19*W/24, y+16*H/24)
  cpx = x+20*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+17*H/24)
  cpx = x+20*W/24
  cpy = y+19*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+19*H/24)
  cpx = x+20*W/24
  cpy = y+20*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+18*W/24, y+20*H/24)
  cpx = x+6*W/24
  cpy = y+20*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+20*H/24)
  cpx = x+4*W/24
  cpy = y+20*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+18*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+20*W/24, y+14*H/24)
  cpx = x+22*W/24
  cpy = y+14*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+12*H/24)
  cpx = x+22*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+10*H/24)
  cpx = x+10*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+10*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+10*H/24)
  cpx = x+15*W/24
  cpy = y+4*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+4*H/24)
  cpx = x+3*W/24
  cpy = y+4*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+3*W/24, y+10*H/24)
  cpx = x+3*W/24
  cpy = y+20*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+3*W/24, y+20*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+8*H/24)
  cpx = x+9*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+8*H/24)
  cpx = x+9*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+10*H/24)
  cpx = x+6*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+8*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+11*W/24, y+8*H/24)
  cpx = x+14*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+8*H/24)
  cpx = x+14*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/24, y+10*H/24)
  cpx = x+11*W/24
  cpy = y+10*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+11*W/24, y+8*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+4*W/24, y+6*H/24)
  cpx = x+2*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+4*H/24)
  cpx = x+2*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+2*H/24)
  cpx = x+4*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+6*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+14*W/24, y+6*H/24)
  cpx = x+14*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+2*H/24)
  cpx = x+16*W/24
  cpy = y+2*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+4*H/24)
  cpx = x+16*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+6*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+16*W/24, y+20*H/24)
  ctx.lineTo(x+16*W/24, y+22*H/24)
  ctx.stroke()

  ctx.beginPath()
  ctx.moveTo(x+3*W/24, y+20*H/24)
  ctx.lineTo(x+3*W/24, y+22*H/24)
  ctx.stroke()
  r *= 2
  ctx.beginPath()
  ctx.arc(x+19*W/24, y+12*H/24, r, 0, Math.PI*2)
  ctx.stroke()

  ctx.beginPath()
  ctx.arc(x+21*W/24, y+12*H/24, r, 0, Math.PI*2)
  ctx.stroke()
}

function flaskAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.lineWidth = 2
  ctx.strokeStyle = "#ffffff"
  ctx.fillStyle = "#ff6666"
  
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+10*W/24, y+8*H/24)
  cpx = x+2*W/24
  cpy = y+20*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+20*H/24)
  cpx = x+2*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+22*H/24)
  cpx = x+20*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+22*H/24)
  cpx = x+22*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+20*H/24)
  cpx = x+14*W/24
  cpy = y+8*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+8*H/24)
  ctx.lineTo(x+14*W/24, y+2*H/24)
  ctx.lineTo(x+10*W/24, y+2*H/24)
  ctx.lineTo(x+10*W/24, y+8*H/24)
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+8*W/24, y+11*H/24)
  ctx.lineTo(x+16*W/24, y+11*H/24)
  ctx.lineTo(x+22*W/24, y+20*H/24)
  cpx = x+22*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+22*H/24)
  cpx = x+4*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+22*H/24)
  cpx = x+2*W/24
  cpy = y+22*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+20*H/24)
  cpx = x+8*W/24
  cpy = y+11*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+11*H/24)
  ctx.fill()

  //3
  ctx.beginPath()
  ctx.moveTo(x+10*W/24, y+1*H/24)
  ctx.lineTo(x+11*W/24, y+5*H/24)
  ctx.lineTo(x+13*W/24, y+5*H/24)
  ctx.lineTo(x+14*W/24, y+1*H/24)
  ctx.lineTo(x+10*W/24, y+1*H/24)
  ctx.fill()
}  

function treasureAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.lineWidth = 2
  ctx.strokeStyle = "yellow"
  ctx.fillStyle = "yellow"
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+10*H/24)
  ctx.lineTo(x+2*W/24, y+6*H/24)
  ctx.lineTo(x+2*W/24, y+19*H/24)
  ctx.lineTo(x+6*W/24, y+23*H/24)
  ctx.lineTo(x+6*W/24, y+10*H/24)
  //ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+23*H/24)
  ctx.lineTo(x+23*W/24, y+23*H/24)
  ctx.lineTo(x+23*W/24, y+10*H/24)
  ctx.lineTo(x+6*W/24, y+10*H/24)
  //ctx.fill()
  ctx.stroke()

  //3
  ctx.beginPath()
  ctx.moveTo(x+6*W/24, y+10*H/24)
  cpx = x+6*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+1*H/24)
  cpx = x+2*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+6*H/24)
  ctx.stroke()

  //4
  ctx.beginPath()
  ctx.moveTo(x+23*W/24, y+10*H/24)
  cpx = x+23*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+21*W/24, y+1*H/24)
  cpx = x+4*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+1*H/24)
  ctx.stroke()

  //5
  ctx.beginPath()
  ctx.moveTo(x+7*W/24, y+1*H/24)
  cpx = x+9*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+10*H/24)
  ctx.stroke()

  //6
  ctx.beginPath()
  ctx.moveTo(x+8*W/24, y+1*H/24)
  cpx = x+10*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+10*H/24)
  //ctx.fill()
  ctx.stroke()

  //7
  ctx.beginPath()
  ctx.moveTo(x+18*W/24, y+1*H/24)
  cpx = x+20*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+10*H/24)
  // ctx.fill()
  ctx.stroke()

  //8
  ctx.beginPath()
  ctx.moveTo(x+17*W/24, y+1*H/24)
  cpx = x+19*W/24
  cpy = y+1*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+19*W/24, y+10*H/24)
  //ctx.fill()
  ctx.stroke()
  ctx.fillStyle = "black"
  //9
  ctx.beginPath()
  ctx.moveTo(x+15*W/24, y+16*H/24)
  cpx = x+13*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+13*W/24, y+14*H/24)
  cpx = x+13*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+12*H/24)
  cpx = x+17*W/24
  cpy = y+12*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+17*W/24, y+14*H/24)
  cpx = x+17*W/24
  cpy = y+16*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+16*H/24)
  ctx.stroke()

  //10
  ctx.beginPath()
  ctx.moveTo(x+14*W/24, y+15*H/24)
  ctx.lineTo(x+14*W/24, y+19*H/24)
  ctx.lineTo(x+16*W/24, y+19*H/24)
  ctx.lineTo(x+16*W/24, y+15*H/24)
  ctx.lineTo(x+14*W/24, y+15*H/24)
  ctx.stroke()
}
  
  function ghostAt (x,y,W,color) {
    let canvas = document.getElementById("OC")
    let ctx = canvas.getContext("2d")
    let H = W, cpx, cpy, points = []
    ctx.lineWidth = 2
    ctx.strokeStyle = color
    ctx.lineCap = "square"
    ctx.lineJoin = "bevel"
    //1
    ctx.beginPath()
    ctx.moveTo(x+2*W/24, y+20*H/24)
    cpx = x+2*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+4*W/24, y+22*H/24)
    cpx = x+6*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+20*H/24)
    cpx = x+6*W/24
    cpy = y+18*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+18*H/24)
    cpx = x+10*W/24
    cpy = y+18*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+20*H/24)
    cpx = x+10*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+22*H/24)
    cpx = x+14*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+20*H/24)
    cpx = x+14*W/24
    cpy = y+18*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+18*H/24)
    cpx = x+18*W/24
    cpy = y+18*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+18*W/24, y+20*H/24)
    cpx = x+18*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+20*W/24, y+22*H/24)
    cpx = x+22*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+20*H/24)
    cpx = x+22*W/24
    cpy = y+10*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+10*H/24)
    cpx = x+22*W/24
    cpy = y+1*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+1*H/24)
    cpx = x+2*W/24
    cpy = y+1*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+10*H/24)
    cpx = x+2*W/24
    cpy = y+20*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+20*H/24)
    ctx.stroke()
  
    //2
    ctx.beginPath()
    ctx.moveTo(x+22*W/24, y+20*H/24)
    cpx = x+22*W/24
    cpy = y+10*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+10*H/24)
    cpx = x+22*W/24
    cpy = y+1*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+1*H/24)
    ctx.stroke()
  
    //3
    ctx.beginPath()
    ctx.moveTo(x+8*W/24, y+10*H/24)
    cpx = x+6*W/24
    cpy = y+10*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+6*W/24, y+8*H/24)
    cpx = x+6*W/24
    cpy = y+6*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+6*H/24)
    cpx = x+10*W/24
    cpy = y+6*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+8*H/24)
    cpx = x+10*W/24
    cpy = y+10*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+10*H/24)
    ctx.stroke()
  
    //4
    ctx.beginPath()
    ctx.moveTo(x+16*W/24, y+10*H/24)
    cpx = x+14*W/24
    cpy = y+10*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+8*H/24)
    cpx = x+14*W/24
    cpy = y+6*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+6*H/24)
    cpx = x+18*W/24
    cpy = y+6*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+18*W/24, y+8*H/24)
    cpx = x+18*W/24
    cpy = y+10*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+10*H/24)
    ctx.stroke()
  
    //5
    ctx.beginPath()
    ctx.moveTo(x+12*W/24, y+17*H/24)
    cpx = x+10*W/24
    cpy = y+17*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+10*W/24, y+15*H/24)
    cpx = x+10*W/24
    cpy = y+11*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+11*H/24)
    cpx = x+14*W/24
    cpy = y+11*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+14*W/24, y+15*H/24)
    cpx = x+14*W/24
    cpy = y+17*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+17*H/24)
    ctx.stroke()
  }
  
function treeAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  color = '#88ff88'
  ctx.strokeStyle = color
  ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  ctx.beginPath()
  ctx.moveTo(x+11*W/24, y+20*H/24)
  ctx.lineTo(x+11*W/24, y+22*H/24)
  ctx.lineTo(x+13*W/24, y+22*H/24)
  ctx.lineTo(x+13*W/24, y+20*H/24)
  ctx.lineTo(x+22*W/24, y+20*H/24)
  ctx.lineTo(x+13*W/24, y+14*H/24)
  ctx.lineTo(x+20*W/24, y+14*H/24)
  ctx.lineTo(x+13*W/24, y+8*H/24)
  ctx.lineTo(x+18*W/24, y+8*H/24)
  ctx.lineTo(x+12*W/24, y+2*H/24)
  ctx.lineTo(x+6*W/24, y+8*H/24)
  ctx.lineTo(x+11*W/24, y+8*H/24)
  ctx.lineTo(x+4*W/24, y+14*H/24)
  ctx.lineTo(x+11*W/24, y+14*H/24)
  ctx.lineTo(x+2*W/24, y+20*H/24)
  ctx.lineTo(x+11*W/24, y+20*H/24)
  ctx.fill()
}

function houseAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy
  ctx.fillStyle = "#ee90ee"
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+10*W/24, y+23*H/24)
  ctx.lineTo(x+2*W/24, y+23*H/24)
  ctx.lineTo(x+2*W/24, y+10*H/24)
  ctx.lineTo(x+12*W/24, y+1*H/24)
  ctx.lineTo(x+16*W/24, y+4*H/24)
  ctx.lineTo(x+16*W/24, y+1*H/24)
  ctx.lineTo(x+18*W/24, y+1*H/24)
  ctx.lineTo(x+18*W/24, y+6*H/24)
  ctx.lineTo(x+22*W/24, y+10*H/24)
  ctx.lineTo(x+22*W/24, y+23*H/24)
  ctx.lineTo(x+13*W/24, y+23*H/24)
  ctx.lineTo(x+13*W/24, y+18*H/24)
  ctx.lineTo(x+10*W/24, y+18*H/24)
  ctx.lineTo(x+10*W/24, y+23*H/24)
  ctx.fill()
}

function filledAt (x,y,W,color) {
  if (MAP === "Fearful Forest") {
    treeAt(x,y,W,color)
    return
  }
  if (MAP === "Haunted Houses") {
    houseAt(x,y,W,color)
    return
  }
  if (MAP === "Cluttered with Chairs") {
    falling_chairAt(x,y,W,color)
    return
  }
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.fillStyle = retrocolors[1]//"#a0a0ff"
  ctx.lineWidth = 2
  ctx.globalAlpha *= 0.8
  //1
  ctx.beginPath()
  ctx.moveTo(x,y)
  ctx.lineTo(x+W,y)
  ctx.lineTo(x+W,y+H)
  ctx.lineTo(x,y+H)
  ctx.closePath()
  ctx.fill()
ctx.lineWidth = 4
  ctx.strokeStyle = retrocolors[0]//"#85a715"//["#85a715", "#71941d", "#597c26", "#3e6230"]
  ctx.globalAlpha = 1
  ctx.beginPath()
  ctx.moveTo(x,y+H)
  ctx.lineTo(x,y)
  ctx.lineTo(x+W,y)
  ctx.stroke()

  ctx.strokeStyle = retrocolors[3]//["#85a715", "#71941d", "#597c26", "#3e6230"]
  ctx.globalAlpha = 1
  ctx.beginPath()
  ctx.moveTo(x,y+H)
  ctx.lineTo(x+W,y+H)
  ctx.lineTo(x+W,y)
  ctx.stroke()
  ctx.lineWidth = 1
}

function rotatePoint (x, y, centerx, centery, degrees) {
  let newx = (x - centerx) * Math.cos(degrees * Math.PI / 180) - (y - centery) * Math.sin(degrees * Math.PI / 180) + centerx;
  let newy = (x - centerx) * Math.sin(degrees * Math.PI / 180) + (y - centery) * Math.cos(degrees * Math.PI / 180) + centery;
  return [newx, newy];
}

function falling_chairAt (x,y,W,color,n) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = "#dd90dd"
  //ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  let p = [], cp = [], lastp = []
  let cx = x+W/2, cy = y+H/2
  let angle = Math.random() *90
  if (Math.random() > 0.5)
    angle *= -1
  //1
  ctx.beginPath()
  p = rotatePoint(x+20*W/24, y+2*H/24 ,cx,cy,angle)
  ctx.moveTo(p[0],p[1])
  p = rotatePoint(x+10*W/24, y+2*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  p = rotatePoint(x+6*W/24, y+9*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  p = rotatePoint(x+16*W/24, y+9*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  p = rotatePoint(x+20*W/24, y+2*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  ctx.stroke()

  //2
  ctx.beginPath()
  p = rotatePoint(x+16*W/24, y+9*H/24 ,cx,cy,angle)
  ctx.moveTo(p[0],p[1])
  p = rotatePoint(x+20*W/24, y+16*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  p = rotatePoint(x+10*W/24, y+16*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  p = rotatePoint(x+6*W/24, y+9*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  ctx.stroke()

  //3
  ctx.beginPath()
  p = rotatePoint(x+6*W/24, y+9*H/24 ,cx,cy,angle)
  ctx.moveTo(p[0],p[1])
  p = rotatePoint(x+2*W/24, y+16*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  ctx.stroke()

  //4
  ctx.beginPath()
  p = rotatePoint(x+10*W/24, y+16*H/24 ,cx,cy,angle)
  ctx.moveTo(p[0],p[1])
  p = rotatePoint(x+6*W/24, y+23*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  ctx.stroke()

  //5
  ctx.beginPath()
  p = rotatePoint(x+20*W/24, y+16*H/24 ,cx,cy,angle)
  ctx.moveTo(p[0],p[1])
  p = rotatePoint(x+16*W/24, y+23*H/24 ,cx,cy,angle)
  ctx.lineTo(p[0],p[1])
  ctx.stroke()
}

  function dotAt (x,y,W,color) {
    let canvas = document.getElementById("OC")
    let ctx = canvas.getContext("2d")
    let H = W, cpx, cpy, points = []
    ctx.fillStyle = color
    ctx.globalAlpha /=2
    //1
    ctx.beginPath()
    ctx.arc(x+W/2-1,y+H/2-1, W/10, 0, Math.PI*2)
   // ctx.fill()
    ctx.globalAlpha *=2
  }
  
  function coinAt (x,y,W,color) {
    let canvas = document.getElementById("OC")
    let ctx = canvas.getContext("2d")
    let H = W, cpx, cpy, points = []
    ctx.lineWidth = 2
    ctx.strokeStyle = "yellow"
    ctx.lineCap = "square"
    ctx.lineJoin = "bevel"
    //1
    ctx.beginPath()
    ctx.moveTo(x+12*W/24, y+20*H/24)
    cpx = x+22*W/24
    cpy = y+20*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+22*W/24, y+10*H/24)
    cpx = x+22*W/24
    cpy = y+0*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+0*H/24)
    cpx = x+2*W/24
    cpy = y+0*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+10*H/24)
    cpx = x+2*W/24
    cpy = y+20*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+20*H/24)
    ctx.stroke()
  
    //2
    ctx.beginPath()
    ctx.moveTo(x+22*W/24, y+12*H/24)
    cpx = x+22*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+22*H/24)
    cpx = x+2*W/24
    cpy = y+22*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+2*W/24, y+12*H/24)
    ctx.stroke()
  
    //3
    ctx.beginPath()
    ctx.moveTo(x+16*W/24, y+6*H/24)
    cpx = x+16*W/24
    cpy = y+4*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+4*H/24)
    cpx = x+8*W/24
    cpy = y+4*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+8*W/24, y+10*H/24)
    cpx = x+8*W/24
    cpy = y+16*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+16*H/24)
    cpx = x+16*W/24
    cpy = y+16*H/24
    ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+14*H/24)
    ctx.stroke()
  
    //4
    ctx.beginPath()
    ctx.moveTo(x+12*W/24, y+2*H/24)
    ctx.lineTo(x+12*W/24, y+18*H/24)
    ctx.stroke()
  }

function skullAt (x,y,W,color,n) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W
  ctx.strokeStyle = color
  ctx.lineCap = "butt"
  ctx.lineJoin = "round"
  let x0 = x, y0 = y
  let p = W/30
  let divs = randomPick([7,9])
  let r = W/3
  ctx.lineWidth = 2
  // top
  ctx.beginPath()
  ctx.arc(x+W/2, y+r, r, Math.PI *0.8, Math.PI*2.2)
  
  // bottom jaw
  ctx.arc(x+W/2, y+H-r*0.9, r*0.8, Math.PI *0.1, Math.PI*0.9)
  ctx.closePath()
  ctx.stroke()
  
  // mouth
  ctx.beginPath()
  ctx.arc(x+W/2, y+H-r*1.36, r*0.8, Math.PI *0.2, Math.PI*0.8)
  ctx.stroke()
  
  // teeth
  let N = randomPick([8,10,12])
  let th = H/20
  let a = (Math.PI * 0.6)/N, angle = Math.PI*0.2
  let cx = x+W/2, cy = y+H-r*1.36
  let i = 0
  for (; i < N+1; i++) {
    x = r*0.8 * Math.cos(angle)+cx
    y = r*0.8 * Math.sin(angle)+cy
    ctx.beginPath()
    ctx.moveTo(x, y - th)
    ctx.lineTo(x, y + th)
    ctx.stroke()
    angle += a
  }
  x = x0, y = y0
  r = W/11
  // eyes
  let r2 = r
  ctx.beginPath()
  ctx.arc(x+W/2-r*1.5, y+H/2-r/3, r2, 0, Math.PI*2)
  ctx.stroke()
  ctx.beginPath()
  ctx.arc(x+W/2+r*1.5, y+H/2-r/3, r2, 0, Math.PI*2)
  ctx.stroke()
  // nose
  ctx.beginPath()
  ctx.moveTo(x+W/2, y+H/2)
  ctx.lineTo(x+W/2+r/2, y +H/2+r*1.5)
  ctx.lineTo(x+W/2-r/2, y +H/2+r*1.5)
  ctx.closePath()
  ctx.stroke()
}

function figureLAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = 'white'
  ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+16*H/24)
  ctx.lineTo(x+9*W/24, y+23*H/24)
  ctx.lineTo(x+4*W/24, y+21*H/24)
  ctx.lineTo(x+8*W/24, y+13*H/24)
  ctx.lineTo(x+8*W/24, y+8*H/24)
  ctx.lineTo(x+6*W/24, y+12*H/24)
  ctx.lineTo(x+2*W/24, y+14*H/24)
  ctx.lineTo(x+2*W/24, y+12*H/24)
  ctx.lineTo(x+5*W/24, y+10*H/24)
  ctx.lineTo(x+7*W/24, y+6*H/24)
  ctx.lineTo(x+17*W/24, y+6*H/24)
  ctx.lineTo(x+21*W/24, y+10*H/24)
  ctx.lineTo(x+17*W/24, y+13*H/24)
  ctx.lineTo(x+16*W/24, y+11*H/24)
  ctx.lineTo(x+18*W/24, y+10*H/24)
  ctx.lineTo(x+16*W/24, y+8*H/24)
  ctx.lineTo(x+16*W/24, y+11*H/24)
  ctx.lineTo(x+17*W/24, y+13*H/24)
  ctx.lineTo(x+20*W/24, y+23*H/24)
  ctx.lineTo(x+15*W/24, y+23*H/24)
  ctx.lineTo(x+12*W/24, y+16*H/24)
  ctx.fill()
  ctx.stroke()
  //2
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+6*H/24)
  cpx = x+9*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+3*H/24)
  cpx = x+9*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+0*H/24)
  cpx = x+15*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+3*H/24)
  cpx = x+15*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+6*H/24)
  ctx.fill()
  ctx.stroke()
}

function figureUAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy
  ctx.fillStyle = color
  ctx.strokeStyle = 'white'
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+6*H/24)
  cpx = x+15*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+3*H/24)
  cpx = x+15*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+0*H/24)
  cpx = x+9*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+3*H/24)
  cpx = x+9*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+6*H/24)
  ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+13*W/24, y+23*H/24)
  ctx.lineTo(x+19*W/24, y+23*H/24)
  ctx.lineTo(x+16*W/24, y+13*H/24)
  ctx.lineTo(x+16*W/24, y+8*H/24)
  ctx.lineTo(x+21*W/24, y+6*H/24)
  ctx.lineTo(x+21*W/24, y+1*H/24)
  ctx.lineTo(x+19*W/24, y+1*H/24)
  ctx.lineTo(x+19*W/24, y+5*H/24)
  ctx.lineTo(x+16*W/24, y+6*H/24)
  ctx.lineTo(x+7*W/24, y+6*H/24)
  ctx.lineTo(x+4*W/24, y+5*H/24)
  ctx.lineTo(x+4*W/24, y+1*H/24)
  ctx.lineTo(x+2*W/24, y+1*H/24)
  ctx.lineTo(x+2*W/24, y+6*H/24)
  ctx.lineTo(x+8*W/24, y+8*H/24)
  ctx.lineTo(x+8*W/24, y+13*H/24)
  ctx.lineTo(x+6*W/24, y+23*H/24)
  ctx.lineTo(x+11*W/24, y+23*H/24)
  ctx.lineTo(x+12*W/24, y+16*H/24)
  ctx.lineTo(x+13*W/24, y+23*H/24)
  ctx.fill()
  ctx.stroke()
}

function figureDAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy
  ctx.fillStyle = color
  ctx.strokeStyle = 'white'
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+8*H/24)
  ctx.lineTo(x+11*W/24, y+1*H/24)
  ctx.lineTo(x+5*W/24, y+1*H/24)
  ctx.lineTo(x+8*W/24, y+11*H/24)
  ctx.lineTo(x+8*W/24, y+16*H/24)
  ctx.lineTo(x+3*W/24, y+18*H/24)
  ctx.lineTo(x+3*W/24, y+23*H/24)
  ctx.lineTo(x+5*W/24, y+23*H/24)
  ctx.lineTo(x+5*W/24, y+19*H/24)
  ctx.lineTo(x+8*W/24, y+18*H/24)
  ctx.lineTo(x+17*W/24, y+18*H/24)
  ctx.lineTo(x+20*W/24, y+19*H/24)
  ctx.lineTo(x+20*W/24, y+23*H/24)
  ctx.lineTo(x+22*W/24, y+23*H/24)
  ctx.lineTo(x+22*W/24, y+18*H/24)
  ctx.lineTo(x+16*W/24, y+16*H/24)
  ctx.lineTo(x+16*W/24, y+11*H/24)
  ctx.lineTo(x+18*W/24, y+1*H/24)
  ctx.lineTo(x+13*W/24, y+1*H/24)
  ctx.lineTo(x+12*W/24, y+8*H/24)
  ctx.fill()
  ctx.stroke()

  //2
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+24*H/24)
  cpx = x+15*W/24
  cpy = y+24*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+21*H/24)
  cpx = x+15*W/24
  cpy = y+18*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+18*H/24)
  cpx = x+9*W/24
  cpy = y+18*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+21*H/24)
  cpx = x+9*W/24
  cpy = y+24*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+24*H/24)
  ctx.fill()
  ctx.stroke()
}

function figureRAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, cpx, cpy, points = []
  ctx.strokeStyle = 'white'
  ctx.fillStyle = color
  ctx.lineCap = "square"
  ctx.lineJoin = "bevel"
  //1
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+16*H/24)
  cpx = x+16*W/24
  cpy = y+23*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+16*W/24, y+23*H/24)
  ctx.lineTo(x+20*W/24, y+21*H/24)
  ctx.lineTo(x+16*W/24, y+13*H/24)
  ctx.lineTo(x+16*W/24, y+8*H/24)
  ctx.lineTo(x+18*W/24, y+12*H/24)
  ctx.lineTo(x+22*W/24, y+14*H/24)
  ctx.lineTo(x+22*W/24, y+12*H/24)
  ctx.lineTo(x+19*W/24, y+10*H/24)
  ctx.lineTo(x+17*W/24, y+6*H/24)
  ctx.lineTo(x+12*W/24, y+6*H/24)
  ctx.lineTo(x+7*W/24, y+6*H/24)
  ctx.lineTo(x+3*W/24, y+10*H/24)
  ctx.lineTo(x+7*W/24, y+13*H/24)
  ctx.lineTo(x+8*W/24, y+11*H/24)
  ctx.lineTo(x+6*W/24, y+10*H/24)
  ctx.lineTo(x+8*W/24, y+8*H/24)
  ctx.lineTo(x+8*W/24, y+11*H/24)
  ctx.lineTo(x+7*W/24, y+13*H/24)
  ctx.lineTo(x+4*W/24, y+23*H/24)
  ctx.lineTo(x+9*W/24, y+23*H/24)
  ctx.lineTo(x+12*W/24, y+16*H/24)
  ctx.fill()
  ctx.stroke()
  //4
  ctx.beginPath()
  ctx.moveTo(x+12*W/24, y+6*H/24)
  cpx = x+15*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+15*W/24, y+3*H/24)
  cpx = x+15*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+0*H/24)
  cpx = x+9*W/24
  cpy = y+0*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+9*W/24, y+3*H/24)
  cpx = x+9*W/24
  cpy = y+6*H/24
  ctx.quadraticCurveTo(cpx, cpy, x+12*W/24, y+6*H/24)
  ctx.fill()
  ctx.stroke()
}

function invaderAt (x,y,W,color) {
  let canvas = document.getElementById("OC")
  let ctx = canvas.getContext("2d")
  let H = W, p = 0
  ctx.fillStyle = color
  //1
  ctx.beginPath()
  ctx.moveTo(x+0*W/12, y+8*H/12)
  ctx.rect(x+0*W/12, y+8*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //2
  ctx.beginPath()
  ctx.moveTo(x+0*W/12, y+7*H/12)
  ctx.rect(x+0*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //3
  ctx.beginPath()
  ctx.moveTo(x+0*W/12, y+6*H/12)
  ctx.rect(x+0*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //4
  ctx.beginPath()
  ctx.moveTo(x+1*W/12, y+6*H/12)
  ctx.rect(x+1*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //5
  ctx.beginPath()
  ctx.moveTo(x+1*W/12, y+5*H/12)
  ctx.rect(x+1*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //6
  ctx.beginPath()
  ctx.moveTo(x+2*W/12, y+4*H/12)
  ctx.rect(x+2*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //7
  ctx.beginPath()
  ctx.moveTo(x+3*W/12, y+4*H/12)
  ctx.rect(x+3*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //8
  ctx.beginPath()
  ctx.moveTo(x+4*W/12, y+4*H/12)
  ctx.rect(x+4*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //9
  ctx.beginPath()
  ctx.moveTo(x+5*W/12, y+4*H/12)
  ctx.rect(x+5*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //10
  ctx.beginPath()
  ctx.moveTo(x+2*W/12, y+5*H/12)
  ctx.rect(x+2*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //11
  ctx.beginPath()
  ctx.moveTo(x+2*W/12, y+6*H/12)
  ctx.rect(x+2*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //12
  ctx.beginPath()
  ctx.moveTo(x+2*W/12, y+7*H/12)
  ctx.rect(x+2*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //13
  ctx.beginPath()
  ctx.moveTo(x+2*W/12, y+8*H/12)
  ctx.rect(x+2*W/12, y+8*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //14
  ctx.beginPath()
  ctx.moveTo(x+3*W/12, y+9*H/12)
  ctx.rect(x+3*W/12, y+9*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //15
  ctx.beginPath()
  ctx.moveTo(x+4*W/12, y+9*H/12)
  ctx.rect(x+4*W/12, y+9*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //16
  ctx.beginPath()
  ctx.moveTo(x+6*W/12, y+9*H/12)
  ctx.rect(x+6*W/12, y+9*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //17
  ctx.beginPath()
  ctx.moveTo(x+7*W/12, y+9*H/12)
  ctx.rect(x+7*W/12, y+9*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //18
  ctx.beginPath()
  ctx.moveTo(x+8*W/12, y+8*H/12)
  ctx.rect(x+8*W/12, y+8*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //19
  ctx.beginPath()
  ctx.moveTo(x+8*W/12, y+7*H/12)
  ctx.rect(x+8*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //20
  ctx.beginPath()
  ctx.moveTo(x+8*W/12, y+6*H/12)
  ctx.rect(x+8*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //21
  ctx.beginPath()
  ctx.moveTo(x+10*W/12, y+6*H/12)
  ctx.rect(x+10*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //22
  ctx.beginPath()
  ctx.moveTo(x+10*W/12, y+7*H/12)
  ctx.rect(x+10*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //23
  ctx.beginPath()
  ctx.moveTo(x+10*W/12, y+8*H/12)
  ctx.rect(x+10*W/12, y+8*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //24
  ctx.beginPath()
  ctx.moveTo(x+9*W/12, y+6*H/12)
  ctx.rect(x+9*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //25
  ctx.beginPath()
  ctx.moveTo(x+3*W/12, y+7*H/12)
  ctx.rect(x+3*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //26
  ctx.beginPath()
  ctx.moveTo(x+4*W/12, y+7*H/12)
  ctx.rect(x+4*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //27
  ctx.beginPath()
  ctx.moveTo(x+5*W/12, y+7*H/12)
  ctx.rect(x+5*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //28
  ctx.beginPath()
  ctx.moveTo(x+6*W/12, y+7*H/12)
  ctx.rect(x+6*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //29
  ctx.beginPath()
  ctx.moveTo(x+7*W/12, y+7*H/12)
  ctx.rect(x+7*W/12, y+7*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //30
  ctx.beginPath()
  ctx.moveTo(x+3*W/12, y+6*H/12)
  ctx.rect(x+3*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //31
  ctx.beginPath()
  ctx.moveTo(x+4*W/12, y+6*H/12)
  ctx.rect(x+4*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //32
  ctx.beginPath()
  ctx.moveTo(x+5*W/12, y+6*H/12)
  ctx.rect(x+5*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //33
  ctx.beginPath()
  ctx.moveTo(x+6*W/12, y+6*H/12)
  ctx.rect(x+6*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //34
  ctx.beginPath()
  ctx.moveTo(x+7*W/12, y+6*H/12)
  ctx.rect(x+7*W/12, y+6*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //35
  ctx.beginPath()
  ctx.moveTo(x+9*W/12, y+5*H/12)
  ctx.rect(x+9*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //36
  ctx.beginPath()
  ctx.moveTo(x+8*W/12, y+4*H/12)
  ctx.rect(x+8*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //37
  ctx.beginPath()
  ctx.moveTo(x+7*W/12, y+4*H/12)
  ctx.rect(x+7*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //38
  ctx.beginPath()
  ctx.moveTo(x+6*W/12, y+4*H/12)
  ctx.rect(x+6*W/12, y+4*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //39
  ctx.beginPath()
  ctx.moveTo(x+4*W/12, y+5*H/12)
  ctx.rect(x+4*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //40
  ctx.beginPath()
  ctx.moveTo(x+5*W/12, y+5*H/12)
  ctx.rect(x+5*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //41
  ctx.beginPath()
  ctx.moveTo(x+6*W/12, y+5*H/12)
  ctx.rect(x+6*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //42
  ctx.beginPath()
  ctx.moveTo(x+8*W/12, y+5*H/12)
  ctx.rect(x+8*W/12, y+5*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //43
  ctx.beginPath()
  ctx.moveTo(x+3*W/12, y+3*H/12)
  ctx.rect(x+3*W/12, y+3*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //44
  ctx.beginPath()
  ctx.moveTo(x+2*W/12, y+2*H/12)
  ctx.rect(x+2*W/12, y+2*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //45
  ctx.beginPath()
  ctx.moveTo(x+7*W/12, y+3*H/12)
  ctx.rect(x+7*W/12, y+3*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
  //46
  ctx.beginPath()
  ctx.moveTo(x+8*W/12, y+2*H/12)
  ctx.rect(x+8*W/12, y+2*H/12,W/12-p,W/12-p)
  ctx.closePath()
  ctx.fill()
}

function randomPick (array) {
    return array[Math.floor((array.length) * Math.random())]
}

function statusbar () {
  let screen = document.getElementById("myCanvas")
  let sctx = screen.getContext("2d")
  let saved = sctx.fillStyle
  sctx.fillStyle = "#ff9090"
  sctx.font = "800 30px Courier"
  let text = "HP:" + HP + " Coins:" +COINS
  if (KEYS > 0)
    text += " Keys:"+KEYS
  if (MASKS > 0)
    text += " MASK ON"
  if (SWORDS > 0) {
    text += " Swords:"+HITS
    //text += " ("+HITS+" hits remaining)"
  }
  sctx.font="500 13pt Courier"
  sctx.fillText(text, 8, 444)

  sctx.fillText(MAP  + " Level:" +LEVEL, 8, 18)
  sctx.fillStyle = saved
}

function message (text) {
  showMessage(text, document.getElementById("myCanvas"))
}

function showMessage (msg, item) {
  var e = document.getElementById("message")
  e.innerHTML = msg;
  e.style.display = "block"
  let rect = document.getElementById("myCanvas").getBoundingClientRect()
  e.style.left = "100px" 
  e.style.top = "80px"
  e.style.padding = "10px"
  setTimeout(function() {
    e.style.display = "none"
    e.innerHTML = ""
  }, 2000);
}

/* Randomize array in-place using Durstenfeld shuffle algorithm */
function shuffleArray (array) {
  for (var i = array.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var temp = array[i];
    array[i] = array[j];
    array[j] = temp;
  }
}
</script>
</body>
</html>